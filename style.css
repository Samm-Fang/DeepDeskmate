body {
    font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background-color: #f4f7f6;
    color: #333;
    margin: 0;
    padding: 0; /* Remove body padding, handle spacing with wrapper */
    line-height: 1.6;
    display: flex;
    flex-direction: column; /* Ensure .app-wrapper and #footer stack vertically */
    min-height: 100vh;
    box-sizing: border-box;
}

.app-wrapper { /* New wrapper for main content and sidebar */
    display: flex;
    width: 100%;
    height: 100vh; /* Full viewport height */
    box-sizing: border-box;
    position: relative; /* For potential absolute positioning of sidebar if needed, or just for structure */
    overflow-x: hidden; /* Prevent horizontal scrollbar during transition */
}

/* 新的侧边栏触发按钮样式 */
.sidebar-toggle-button {
    position: fixed;
    bottom: 20px;
    right: 20px; /* 改为右侧 */
    width: 50px;
    height: 50px;
    background-color: #3498db;
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    z-index: 1001; /*确保在其他内容之上，但在侧边栏之下（如果侧边栏打开）*/
    transition: background-color 0.3s ease, right 0.3s ease-in-out; /* 添加 right 过渡 */
}

.sidebar-toggle-button:hover {
    background-color: #2980b9;
}

/* .sidebar.open + .sidebar-toggle-button rule removed as it's ineffective due to DOM structure */
/* Button movement will be handled by JavaScript */


.container { /* Main content area */
    flex-grow: 1;
    background-color: #ffffff;
    padding: 30px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap: 30px;
    overflow-y: auto; /* Allow scrolling for main content if it overflows */
    height: 100%; /* Fill height of app-wrapper */
    transition: margin-right 0.3s ease-in-out, width 0.3s ease-in-out; /* 修改过渡属性 */
    width: 100%; /* 初始宽度 */
}
/* .app-wrapper.sidebar-visible .container is no longer needed in this form */
/* .container.sidebar-open-content-shift is now used */

.main-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px; /* Gap between title and settings button */
}

h1 {
    color: #2c3e50;
    text-align: left; /* Align to left as it's part of a flex row now */
    margin-bottom: 0; /* Margin handled by main-header gap or container gap */
    font-size: 2.3rem;
    font-weight: 700;
}

/* 通用 Section 样式 */
.settings-section,
.input-section,
.output-section,
.table-generator-section {
    background-color: #fdfdfd;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.07);
    border: 1px solid #e9e9e9;
    display: flex;
    flex-direction: column;
    gap: 15px; /* Consistent gap within sections */
}

h2 {
    color: #34495e;
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.7rem;
    border-bottom: 2px solid #3498db;
    padding-bottom: 8px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #555;
    font-size: 1rem;
}

input[type="password"],
textarea,
input[type="text"],
input[type="number"],
select {
    width: 100%; /* Make inputs full width by default */
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 1rem;
    box-sizing: border-box;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

input:focus,
textarea:focus,
select:focus {
    border-color: #3498db;
    box-shadow: 0 0 8px rgba(52, 152, 219, 0.25);
    outline: none;
}

textarea {
    resize: vertical;
    min-height: 90px;
}

button {
    background-color: #3498db;
    color: #ffffff;
    border: none;
    padding: 10px 18px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease, opacity 0.3s ease;
    font-weight: 500;
    line-height: 1.5; /* Ensure text is vertically centered */
}

button:hover {
    background-color: #2980b9;
}

button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
    opacity: 0.7;
}

/* Specific Button Groupings and Alignments */
.settings-section {
    padding: 0; 
    border: none;
    box-shadow: none;
    background-color: transparent;
}
#open-settings-button {
    width: auto; 
}

.input-section {
    gap: 8px; 
}
.description-input-group {
    display: flex;
    align-items: flex-start; 
    gap: 10px;
}
.description-input-group textarea {
    flex-grow: 1; 
    margin-bottom: 0; 
}
.description-input-group #send-description {
    width: auto; 
    flex-shrink: 0; 
}


.output-section .controls {
    display: flex;
    gap: 10px;
}
.output-section .controls button {
    flex-grow: 1; 
}

.import-personnel-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.import-personnel-section button#import-personnel-button {
    align-self: flex-end; 
    width: auto;
}

.import-seat-table-section { 
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 20px; 
    padding-top: 20px; 
    border-top: 1px solid #eee;
}
.import-seat-table-section h3 {
    margin-top: 0;
    margin-bottom: 5px; 
    font-size: 1.2rem; 
    color: #34495e;
}
.import-seat-table-section textarea {
    min-height: 80px; 
}
.import-seat-table-section button {
    align-self: flex-end;
    width: auto;
}

.seat-modification-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.seat-modification-section h3 {
    margin-top: 0;
    margin-bottom: 5px;
    font-size: 1.2rem;
    color: #34495e;
}
.seat-modification-section p {
    font-size: 0.9rem;
    color: #555;
    margin-top: 0;
    margin-bottom: 5px;
}
.seat-modification-section textarea {
    min-height: 60px; 
}
.seat-modification-section button {
    align-self: flex-end;
    width: auto;
}
#seat-modification-output {
    font-size: 0.9rem;
    white-space: pre-wrap; 
    padding: 15px; /* Added padding to match thinking output */
    background-color: transparent; /* Added background to match thinking output */
    border: 2px dashed #cccccc; /* Changed border to match thinking output */
    border-radius: 8px; /* Added border-radius to match thinking output */
    margin-top: 10px; /* Added margin-top to match thinking output */
    /* display: none; /* Initial state if needed, then controlled by JS */
    /* opacity: 0; /* Initial state if needed, then controlled by JS */
    /* transition: opacity 0.3s ease-in-out; /* Transition if needed */
}


.table-generator-section .generator-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
}
.table-generator-section .generator-controls label {
    margin-bottom: 0; 
}
.table-generator-section .generator-controls input[type="number"] {
    width: 70px; 
    margin-bottom: 0; 
}
.table-generator-section .generator-buttons {
    display: flex;
    gap: 10px;
    width: 100%; 
}
.table-generator-section .generator-buttons button {
    flex-grow: 1; 
}


.table-generator-section .arrangement-section {
    display: flex;
    flex-direction: row; 
    gap: 20px; 
    align-items: stretch; /* 改为 stretch 使子项高度一致 */
}

.arrangement-remarks-wrapper, 
#seat-modification-section {
    flex: 1; 
    display: flex;
    flex-direction: column;
    gap: 10px; /* 各自内部子元素的间距 */
    padding: 15px; /* 内边距 */
    border: 1px solid #e0e0e0; /* 边框 */
    border-radius: 8px; /* 圆角 */
    background-color: #f9f9f9; /* 背景色 */
    min-width: 0; /* 允许收缩 */
}

/* 确保这些包装器内的标签和文本区域行为正确 */
.arrangement-remarks-wrapper .section-title-button-group,
#seat-modification-section .section-title-button-group {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px; /* 标题组和下方文本框的间距 */
}

.arrangement-remarks-wrapper .section-title-button-group label,
#seat-modification-section .section-title-button-group h3 {
    margin-bottom: 0; /* 移除label/h3自身的下边距，由父级控制 */
    font-weight: 600;
    font-size: 1.1rem; /* 统一标题字体大小 */
    color: #34495e;   /* 统一标题颜色 */
}

#seat-modification-section .section-title-button-group h3 {
    /* 如果需要更细致的调整h3使其看起来和label完全一样，可以在这里添加，但通常font-weight, size, color已足够 */
}

.inline-button { /* 新增：用于标题旁边按钮的样式 */
    padding: 6px 12px;
    font-size: 0.9rem;
    margin-left: 10px; /* 按钮和标题的间距 */
    flex-shrink: 0; /* 防止按钮被压缩 */
}


.arrangement-remarks-wrapper textarea,
#seat-modification-section textarea {
    width: 100%; 
    box-sizing: border-box; /* padding和border包含在宽度内 */
    min-height: 90px; /* 一致的最小高度 */
}

/* 如果之前#seat-modification-section有特定的边距/内边距/边框覆盖，现在移除它们，除非确实需要 */
#seat-modification-section {
    margin-top: 0 !important; 
    padding-top: 0 !important;
    border-top: none !important;
    /* 保持其他需要的样式，或依赖上面的通用样式 */
    padding: 15px; /* 确保内边距一致 */
    border: 1px solid #e0e0e0; /* 确保边框一致 */
    border-radius: 8px;
    background-color: #f9f9f9;
}

/* ai-arrange-button 现在在 generator-buttons 中，此规则可能不再直接适用或需要调整 */
/* .table-generator-section .arrangement-section button#ai-arrange-button {
    width: 100%; 
    margin-top: 5px; 
} */


/* Output Areas */
#markdown-output, #table-preview {
    border: 1px solid #e0e0e0;
    padding: 15px;
    border-radius: 8px;
    background-color: #ffffff;
    min-height: 120px; /* Base min-height, specific overrides might apply */
    overflow-x: auto; 
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
}

/* Specific styles for #table-preview to handle vertical growth and scrolling */
#table-preview {
    /* flex-grow: 1; Removed as per new requirement */
    /* overflow-y: auto; Removed to allow content to define height */
    /* min-height: 0; Removed to allow content to define height */
    display: flex; 
    flex-direction: column; 
    /* overflow-x: auto; is handled by a more general rule below if needed */
}

/* Markdown Table Styles */
#markdown-output table, #table-preview table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin-top: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
}

#markdown-output th, #markdown-output td, #table-preview th, #table-preview td {
    padding: 10px 12px;
    text-align: left;
    border-bottom: 1px solid #eee;
}
#markdown-output td:not(:last-child), #table-preview td:not(:last-child) {
    border-right: 1px solid #eee; 
}


#markdown-output th, #table-preview th {
    background-color: #f8f9fa;
    font-weight: 600; 
    color: #454d55; 
    border-bottom: 2px solid #dee2e6; 
}
#markdown-output th:not(:last-child), #table-preview th:not(:last-child) {
    border-right: 1px solid #dee2e6; 
}


#markdown-output tr:last-child td, #table-preview tr:last-child td {
    border-bottom: none;
}

#markdown-output tr:nth-child(even) td, #table-preview tr:nth-child(even) td {
    background-color: #f9f9f9; 
}

/* Layout for Output and Table Generator */
.content-wrapper {
    display: flex; 
    gap: 30px;
    align-items: stretch; /* Children will stretch to the height of the tallest item */
    flex-grow: 1; /* Allow it to take available vertical space in .container */
    min-height: 0; /* Important for a flex item that grows, to allow shrinking if needed */
    /* overflow: hidden; /* Consider if clipping is desired for the wrapper itself */
}

.output-section {
    /* display: flex; flex-direction: column; is already set by generic section styles */
    min-height: 800px; /* New requirement */
    flex-shrink: 0; /* Prevent output section from shrinking too much by default */
    flex-basis: 45%; /* Default basis, can be adjusted */
    /* min-width: 320px; Already set */
    transition: width 0.3s ease-in-out, min-width 0.3s ease-in-out, padding 0.3s ease-in-out, flex-basis 0.3s ease-in-out;
}

.table-generator-section {
    /* flex-grow: 1; Removed */
    min-width: 320px; 
    /* display: flex; flex-direction: column; is already set by generic section styles */
    align-self: flex-start; /* Prevent stretching if output-section's min-height makes it taller */
}


@media (max-width: 767px) { 
    .content-wrapper {
        flex-direction: column;
    }
    .output-section, .table-generator-section {
        width: 100%; 
        flex-basis: auto; 
        min-height: auto; /* Reset min-height for stacked view if 800px is too much */
    }
    .output-section {
        min-height: 400px; /* Or a more suitable min-height for mobile */
    }
}


#ai-thinking-output,
.personnel-thinking-output,
.seat-modify-thinking-output {
    padding: 15px;
    background-color: transparent; 
    border: 2px dashed #cccccc; 
    border-radius: 8px;
    margin-top: 10px;
    display: none; 
    opacity: 0; 
    transition: opacity 0.3s ease-in-out; 
}

.thinking-output-visible { 
    display: block !important;
    opacity: 1 !important;
}

#ai-thinking-output h3,
.personnel-thinking-output h3,
.seat-modify-thinking-output h3 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.1rem;
    color: #555; 
    border-bottom: 1px solid #ddd;
    padding-bottom: 5px;
}

#ai-thinking-output pre,
.personnel-thinking-output pre,
.seat-modify-thinking-output pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    max-height: 200px;
    overflow-y: auto;
    background-color: transparent; 
    padding: 10px;
    border-radius: 6px;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    font-size: 0.9rem;
    color: #777777; 
    border: none; 
    opacity: 0;
    animation: fadeInText 0.3s ease-in-out forwards;
    animation-delay: 0.1s; 
}

@keyframes fadeInText {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Styles for special seat modification commands */
.seat-mod-command {
    font-weight: bold;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}
.seat-mod-swap { background-color: #e6f3ff; color: #0056b3; border: 1px solid #b3d9ff; } 
.seat-mod-move { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; } 
.seat-mod-empty { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; } 
.seat-mod-fill { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; } 
.seat-mod-error { background-color: #f8d7da; color: #721c24; font-weight: normal; } 
.seat-mod-message { color: #555; font-style: italic; } 


/* Footer */
#footer {
    text-align: center;
    padding: 15px;
    background-color: #34495e;
    color: #ecf0f1;
    width: 100%;
    box-sizing: border-box;
    opacity: 0;
    transition: opacity 0.5s ease;
    margin-top: auto; 
}

#footer p {
    margin: 0;
    font-size: 0.9rem;
    color: #181818; /* Changed color */
}

#footer a {
    color: #3498db;
    text-decoration: none;
}

#footer a:hover {
    text-decoration: underline;
}

/* Sidebar Styles */
.sidebar {
    width: 350px; 
    height: 100vh; 
    position: fixed; 
    top: 0;
    right: -350px; 
    background-color: #fdfdfd;
    box-shadow: -2px 0 8px rgba(0,0,0,0.1); 
    z-index: 1000; 
    overflow-y: auto;
    overflow-x: hidden;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap: 15px;
    transition: right 0.3s ease-in-out; 
    flex-shrink: 0;
}

.sidebar.open { 
    right: 0; 
}

.container.sidebar-open-content-shift {
    margin-right: 350px; 
}


.sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 10px;
    border-bottom: 2px solid #3498db;
    margin-bottom: 0; 
}

.sidebar-header h2 {
    margin: 0;
    font-size: 1.4rem; 
    color: #34495e;
    border-bottom: none;
    padding-bottom: 0;
}

.sidebar .close-button { 
     color: #999;
     font-size: 26px;
     font-weight: bold;
     cursor: pointer;
     padding: 0 5px; 
}
.sidebar .close-button:hover {
    color: #333;
}

.sidebar-content {
    display: flex;
    flex-direction: column;
    gap: 20px; 
}

.active-config-display {
    background-color: #e9f5ff;
    border: 1px solid #b3d9ff;
    padding: 10px 12px;
    border-radius: 6px;
    font-size: 0.9rem;
    color: #0056b3;
}
.active-config-display p { margin: 0; font-weight: 500; }
.active-config-display strong { color: #004085; }

.config-item-header {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between; 
}
.config-item-header h3 {
    margin: 0; 
    display: flex;
    align-items: center;
    gap: 8px; 
    font-size: 1.1rem;
    color: #34495e;
}
.collapse-icon {
    font-size: 0.8em;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.model-config-item.collapsed .collapse-icon {
    transform: rotate(-90deg);
}

.model-config-item > .config-item-content { 
    max-height: 1000px; 
    overflow: hidden;
    opacity: 1;
    transition: max-height 0.35s cubic-bezier(0.4, 0, 0.2, 1), 
                opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                margin-top 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                padding-top 0.35s cubic-bezier(0.4, 0, 0.2, 1),
                padding-bottom 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    padding-top: 10px; 
    padding-bottom: 10px;
    margin-top: 10px; 
}

.model-config-item.collapsed > .config-item-content {
    max-height: 0;
    opacity: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
}
.active-indicator {
    font-size: 0.8rem;
    color: #27ae60;
    font-weight: bold;
    margin-left: auto; 
}


.deepseek-quick-config, #model-configs-list {
    padding-top: 15px;
    border-top: 1px solid #eee;
}
.deepseek-quick-config:first-child, #model-configs-list:first-child {
     border-top: none;
     padding-top: 0;
}


.deepseek-quick-config h3 { 
    margin-top: 0;
    margin-bottom: 12px;
    font-size: 1.1rem;
    color: #34495e;
}

.model-config-item {
    border: 1px solid #ddd;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 8px;
    background-color: #f9f9f9;
    display: flex;
    flex-direction: column;
    gap: 10px;
    transition: border-color 0.3s ease;
}
.model-config-item.active-config {
    border-color: #27ae60; 
    box-shadow: 0 0 8px rgba(39, 174, 96, 0.3);
}

.config-item-content { 
    display: flex;
    flex-direction: column;
    gap: 10px; 
}


.model-config-item label {
    margin-bottom: 3px; 
    font-weight: 500; 
}

.model-config-item input[type="text"],
.model-config-item input[type="password"],
.model-config-item select {
    width: 100%; 
    padding: 8px;
    margin-bottom: 5px; 
}

.custom-select-wrapper {
    position: relative;
    width: 100%;
}

.custom-select-trigger {
    width: 100%;
    padding: 10px;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 6px;
    text-align: left;
    cursor: pointer;
    font-size: 1rem; 
    color: #333; 
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-sizing: border-box;
}
.custom-select-trigger::after { 
    content: '▼';
    font-size: 0.7em;
    margin-left: 8px;
}
.custom-select-wrapper.open .custom-select-trigger::after {
    content: '▲';
}

.custom-select-dropdown {
    display: none; 
    position: absolute;
    top: 100%; 
    left: 0;
    right: 0;
    background-color: #fff;
    border: 1px solid #ccc;
    border-top: none; 
    border-radius: 0 0 6px 6px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    z-index: 1050; 
    padding: 8px;
    box-sizing: border-box;
}
.custom-select-wrapper.open .custom-select-dropdown {
    display: block;
}

.custom-select-dropdown .model-search-input { 
    width: 100%;
    padding: 8px;
    margin-bottom: 8px; 
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 0.9rem;
    box-sizing: border-box;
}
.custom-select-dropdown .model-search-input:focus {
    border-color: #3498db;
    box-shadow: 0 0 6px rgba(52, 152, 219, 0.2);
    outline: none;
}

.custom-options-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 150px; 
    overflow-y: auto;
}

.custom-options-list li {
    padding: 8px 10px;
    cursor: pointer;
    font-size: 0.95rem;
    border-radius: 4px;
}

.custom-options-list li:hover,
.custom-options-list li.selected { 
    background-color: #e9ecef;
}
.custom-options-list li.hidden-by-search {
    display: none;
}


.model-config-item .models-list {
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px dashed #ccc;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.model-item {
    border: 1px dashed #ccc;
    padding: 10px;
    border-radius: 6px;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.model-item label { font-weight: normal; color: #666; }
.model-item input[type="text"], .model-item select { padding: 7px; margin-bottom: 5px; }
.model-item select[multiple] { height: 70px; }

.model-config-item .config-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}
.model-config-item .config-actions button {
    flex-grow: 1;
    padding: 8px 10px;
    font-size: 0.9rem;
}

button.primary-button { background-color: #3498db; }
button.primary-button:hover { background-color: #2980b9; }
button.primary-button:disabled { background-color: #a9d7f4; color: #777; }


button.secondary-button { background-color: #95a5a6; }
button.secondary-button:hover { background-color: #7f8c8d; }

button.danger-button { background-color: #e74c3c; }
button.danger-button:hover { background-color: #c0392b; }

.model-item button.remove-model, 
.model-config-item button.add-model, 
#add-model-config, 
.deepseek-quick-config button { 
    width: 100%; 
    padding: 9px;
    font-size: 0.95rem;
}
.model-item button.remove-model { background-color: #e74c3c; }
.model-item button.remove-model:hover { background-color: #c0392b; }


.model-list-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}
.model-list-controls h4 { margin: 0; font-size: 1rem; }
.model-list-controls .fetch-models {
     padding: 6px 10px;
     background-color: #5bc0de;
     color: white;
     font-size: 0.9rem;
     width: auto; 
}
.model-list-controls .fetch-models:hover { background-color: #46b8da; }


/* Responsive adjustments */
@media (max-width: 768px) {
    .container {
        padding: 20px;
        margin: 20px 10px; 
        gap: 20px;
    }

    h1 { font-size: 2rem; }
    h2 { font-size: 1.5rem; }

    .input-section #send-description,
    .output-section .controls,
    .table-generator-section .generator-buttons,
    .table-generator-section .arrangement-section, /* Changed from .arrangement-controls */
    .table-generator-section #copy-arranged-table { /* This ID might be inside .generator-buttons now */
        flex-direction: column; 
        align-items: stretch; 
    }
    .input-section #send-description,
    .table-generator-section .arrangement-section button, /* Target button inside .arrangement-section */
    .table-generator-section #copy-arranged-table {
        width: 100%; 
    }
    .output-section .controls button {
        flex-grow: 0; 
    }
     .table-generator-section .generator-controls {
        flex-direction: column;
        align-items: stretch;
    }
    .table-generator-section .generator-controls input[type="number"] {
        width: 100%;
    }
}

/* Scrollbar Styles */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
::-webkit-scrollbar-thumb { background: #aaa; border-radius: 10px; }
::-webkit-scrollbar-thumb:hover { background: #777; }

/* Gender coloring - already present, kept for completeness */
.gender-male { background-color: #e6f3ff; }
.gender-female { background-color: #ffe6f2; }

/* Personnel List Collapsing Styles */
.personnel-list-wrapper {
    transition: width 0.3s ease-in-out, padding 0.3s ease-in-out; /* Removed max-height from transition */
    overflow: hidden; 
    width: 100%; 
    /* max-height: 500px; Removed */
    flex-grow: 1; /* Allow wrapper to grow to fill .output-section */
    overflow-y: auto; /* Always allow scroll if content overflows */
    min-height: 0; /* Important for flex item to shrink correctly */
}

.output-section:not(.personnel-collapsed) .personnel-list-wrapper {
    /* flex-grow: 1; Already set above */
    /* overflow-y: auto; Already set above */
    overflow-x: visible; 
    /* min-height: 0; Already set above */
}

.output-section.personnel-collapsed .personnel-list-wrapper {
    /* width: 100%; Already set by general .personnel-list-wrapper */
    padding: 0; 
    /* overflow-y: auto; Already set by general .personnel-list-wrapper */
    /* flex-grow: 1; Already set by general .personnel-list-wrapper */
    /* min-height: 0; Already set by general .personnel-list-wrapper */
}


.output-section.personnel-collapsed {
    width: 120px; 
    max-width: 170px; 
    min-width: 100px; 
    padding: 10px 5px; 
    flex-basis: 100px; 
    flex-grow: 0; 
    flex-shrink: 0; 
    /* min-height: 800px; will apply unless overridden by media query */
}

/* Styles for the new div-based list in collapsed mode */
.output-section.personnel-collapsed .personnel-list-wrapper #markdown-output .personnel-item {
    padding: 8px 5px;
    font-size: 0.9em;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: default;
    position: relative; 
    border-bottom: 1px solid #eee; 
}
.output-section.personnel-collapsed .personnel-list-wrapper #markdown-output .personnel-item:last-child {
    border-bottom: none;
}
.output-section.personnel-collapsed .personnel-list-wrapper #markdown-output .personnel-item-empty {
    padding: 8px 5px;
    font-size: 0.9em;
    color: #777;
    text-align: center;
}


/* Tooltip for collapsed view (now targets .personnel-item) - REMOVED */
/*
.output-section.personnel-collapsed .personnel-list-wrapper #markdown-output .personnel-item:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 105%; 
    top: 50%;
    transform: translateY(-50%);
    background-color: #333;
    color: #fff;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.85em;
    white-space: pre-wrap; 
    z-index: 1001; 
    margin-left: 5px; 
    min-width: 150px; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    pointer-events: none; 
    display: block !important; 
    opacity: 1 !important; 
    visibility: visible !important; 
}
*/

/* Hide controls except the toggle button when collapsed */
.output-section.personnel-collapsed .controls button:not(#toggle-personnel-list) {
    display: none;
}
.output-section.personnel-collapsed .controls {
    justify-content: center; 
}
.output-section.personnel-collapsed h2,
.output-section.personnel-collapsed .import-personnel-section { 
    display: none;
}
.output-section.personnel-collapsed #loading { 
    display: none !important;
}

/* Styles for table cells in expanded view (if tooltip is also desired there on name) */
#markdown-output table td:first-child {
    position: relative; 
}
/* Optional: Tooltip for expanded view table cells (if desired) - REMOVED */
/*
#markdown-output table td:first-child:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 0; 
    top: 100%; 
    background-color: #333;
    color: #fff;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.85em;
    white-space: pre-wrap; 
    z-index: 1001; 
    margin-top: 2px; 
    min-width: 200px; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    pointer-events: none; 
    display: block !important; 
    opacity: 1 !important; 
    visibility: visible !important; 
}
*/
/* Add word-wrap for table cells, especially remarks, to prevent overflow */
#markdown-output td {
    word-wrap: break-word; 
    overflow-wrap: break-word; 
}


/* Adjust table generator section when personnel list is collapsed */
.content-wrapper.personnel-list-collapsed .table-generator-section { /* 确保此规则存在且正确 */
    flex-grow: 1; 
    width: auto; 
}

.content-wrapper:not(.personnel-list-collapsed) .table-generator-section {
    flex-grow: 0; 
}


/* Ensure the controls button for toggle has appropriate styling if needed */
#toggle-personnel-list {
    min-width: 80px; 
}
.output-section.personnel-collapsed #toggle-personnel-list {
    width: 100%; 
    padding: 10px 5px; 
}

/* Style for original seat number background */
.original-seat-number-bg {
    position: absolute;
    bottom: 2px;
    right: 4px;
    font-size: 0.65em; 
    color: rgba(0, 0, 0, 0.25); 
    z-index: 0; 
    pointer-events: none; 
    font-weight: bold;
}

#table-preview td { 
    position: relative;
}
